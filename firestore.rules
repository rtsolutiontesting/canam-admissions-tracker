rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // Program Snapshots - Require authentication
    match /programSnapshots/{programId} {
      allow read: if request.auth != null; // Authenticated users only
      allow write: if request.auth != null; // Authenticated users only
    }
    
    // Execution Logs - Require authentication
    match /executionLogs/{executionId} {
      allow read: if request.auth != null; // Authenticated users only
      allow write: if request.auth != null; // Authenticated users only
    }
    
    // Rate Limits - Read/Write for service account only
    match /rateLimits/{document=**} {
      allow read, write: if false; // Service account only (via Admin SDK)
    }
    
    // Deny all other access
    match /{document=**} {
      allow read, write: if false;
    }
  }
}

